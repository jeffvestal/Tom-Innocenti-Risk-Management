# Innocenti Risk Management - Enablement Kit

A technical enablement kit demonstrating the **"Full Chain" search pipeline** using **Jina AI models** on **Elastic Inference Service (EIS)**.

## The Scenario

We're simulating a high-stakes legal compliance firm called **"Innocenti & Associates"** that needs to search the **EU AI Act** with precision. Standard search fails on legal nuance—we fix that with a complete pipeline:

1. **Jina Reader** → Converts messy PDFs to clean markdown
2. **Jina Embeddings v3** → Multilingual semantic understanding  
3. **Jina Reranker v3** → Listwise precision (the "Lawyer's Brain")

## Project Structure

```
├── notebooks/
│   ├── 01_ingest.ipynb      # PDF → Structured JSON via Jina Reader
│   ├── 02_index.ipynb       # Index with semantic_text + EIS
│   ├── 03_rerank.ipynb      # Demonstrate Listwise Reranking
│   └── utils/
│       └── credentials.py   # Shared credential management
├── data/
│   └── eu_ai_act_clean.json # Generated by Notebook 01
├── ui/                      # Next.js demo app (Layer B)
└── requirements.txt
```

## Prerequisites

- Python 3.9+
- Elastic Cloud account with API key
- Jina AI API key ([get one here](https://jina.ai/))

## Quick Start

### 1. Clone the repo
```bash
git clone https://github.com/jeffvestal/Tom-Innocenti-Risk-Management.git
cd Tom-Innocenti-Risk-Management
```

### 2. Install dependencies
```bash
pip install -r requirements.txt
```

### 3. Run the notebooks in order
Each notebook will prompt you for credentials on first run. You can optionally save them to a `.env` file for persistence across sessions.

1. **`01_ingest.ipynb`** - Fetches the EU AI Act PDF, cleans it, outputs JSON
2. **`02_index.ipynb`** - Creates Elastic index with `semantic_text`, bulk indexes data
3. **`03_rerank.ipynb`** - Demonstrates raw retrieval vs. reranked results

## Credentials

The notebooks use a secure credential flow:
- First run: `getpass` prompts for secure input
- Optional: Save to `.env` for persistence (never committed to git)
- Subsequent runs: Auto-loads from `.env` if present

Required credentials:
- `ELASTIC_CLOUD_ID` - Your Elastic Cloud deployment ID
- `ELASTIC_API_KEY` - API key with index/search permissions
- `JINA_API_KEY` - Jina AI API key

## Key Concepts Demonstrated

| Notebook | Concept | Jina Product |
|----------|---------|--------------|
| 01 | PDF parsing without OCR | Jina Reader (ReaderLM) |
| 02 | Zero-config embeddings | Jina Embeddings v3 via EIS |
| 03 | Listwise reranking | Jina Reranker v3 via EIS |

## License

MIT
